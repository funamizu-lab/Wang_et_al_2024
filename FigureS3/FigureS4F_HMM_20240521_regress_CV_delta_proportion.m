

function FigureS4F_HMM_20240521_regress_CV_delta_proportion

repeat_before_sound = [
0.0143	0.0143	0.0286	0.1333	0.0714	0.2476	0.4571
0.25	0.25	0	0	0	0.75	0.25
0.0514	0.014	0.028	0.0607	0.0234	0.2243	0.5701
0.1304	0.0435	0.0435	0.1304	0.0435	0.2174	0.5652
];

repeat_sound = [
0.2059	0.1429	0.0336	0.0882	0.0672	0.2227	0.4832
0	0	0	0	0	0.4286	0.2857
0.1087	0.4269	0.0632	0.0316	0.0198	0.1285	0.3063
0.2647	0.1176	0	0.0294	0.0294	0.1765	0.6176
];

repeat_choice = [
0.3007	0.2108	0.5637	0.0572	0.0098	0.1503	0.2745
0.1598	0.0888	0.4556	0.0414	0.0059	0.1006	0.3432
0.222	0.1951	0.5852	0.0538	0.0123	0.139	0.278
0.2568	0.1577	0.4414	0.0315	0.009	0.1171	0.4505
];

repeat_before_sound_neg = [
0	0	0	0	0.0323	0.0645	0.3548
0	0.0667	0	0.1333	0	0	0.1333
0.0357	0.0357	0.0357	0.0357	0	0.1429	0.3214
0	0.5	0	0	0	0	0.5
];

repeat_sound_neg = [
0.0556	0.0833	0.0278	0.0278	0	0.0833	0.2778
0	0.0588	0	0	0	0.0588	0.2353
0.0504	0.2773	0.0168	0.0042	0.0084	0.1092	0.2227
0	0.25	0	0	0	0.25	0
];

repeat_choice_neg = [
0.1127	0.0563	0.3239	0.0282	0.0141	0.0563	0.1549
0.0727	0.0364	0.4364	0.0545	0	0.1273	0.2364
0.1478	0.1773	0.4138	0.0197	0.0345	0.0887	0.2611
0.1515	0.0606	0.5758	0	0	0.2121	0.303
];

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
zigzag_before_sound = [
0.2236	0.022	0.0268	0.2016	0.0772	0.1827	0.6394
0.0339	0	0	0.0847	0.0508	0.0678	0.6949
0.0894	0.0073	0.0088	0.0968	0.0396	0.1378	0.5689
0.1141	0	0.0201	0.2282	0.0268	0.1409	0.7383
0.1046	0.0084	0.0209	0.1883	0.0377	0.2008	0.431
0.1176	0	0.0168	0.1261	0.0672	0.1681	0.4958
];

zigzag_sound = [
0.4206	0.112	0.0575	0.1664	0.0484	0.1498	0.5809
0.2	0.0824	0.0118	0.0588	0.0118	0.0588	0.6118
0.1977	0.4687	0.0585	0.0544	0.0148	0.0651	0.3072
0.3147	0.066	0.0102	0.132	0.066	0.0711	0.7005
0.3221	0.1049	0.0262	0.1273	0.0337	0.1685	0.4831
0.2345	0.0759	0.0345	0.1103	0.0138	0.1655	0.4069
];

zigzag_choice = [
0.4707	0.2667	0.6263	0.098	0.0131	0.1	0.3606
0.2513	0.098	0.5804	0.1156	0.0151	0.0352	0.2437
0.3551	0.2531	0.6586	0.0562	0.0078	0.0477	0.2217
0.4183	0.1662	0.6218	0.0831	0.0258	0.0401	0.3897
0.4971	0.2766	0.6132	0.0774	0.0155	0.1064	0.441
0.3736	0.1705	0.6372	0.0977	0.0155	0.1783	0.4031
];

zigzag_before_sound_neg = [
0.1329	0.0153	0.0204	0.1244	0.0443	0.1261	0.4702
0.1458	0.0042	0.0208	0.0792	0.0208	0.075	0.4667
0.0657	0.0058	0.0117	0.0993	0.0409	0.2073	0.4175
0.1435	0.0093	0.0046	0.1157	0.0417	0.1111	0.5648
0.0472	0.0063	0.0031	0.0629	0.0189	0.1164	0.3899
0.0553	0	0	0.0632	0.0158	0.1395	0.3605
];

zigzag_sound_neg = [
0.1837	0.0424	0.0251	0.1068	0.0188	0.0879	0.3344
0.2215	0.0163	0.013	0.0847	0.0228	0.0717	0.4169
0.0947	0.387	0.0245	0.0462	0.016	0.0674	0.2591
0.2305	0.0532	0.0142	0.1064	0.0426	0.078	0.4929
0.0963	0.0248	0.0155	0.0404	0.0217	0.1056	0.3292
0.1121	0.0117	0.0117	0.0444	0.0117	0.1098	0.2991
];

zigzag_choice_neg = [
0.3991	0.2042	0.4714	0.0945	0.014	0.0782	0.2625
0.2449	0.1224	0.398	0.0969	0.0153	0.0306	0.1531
0.2531	0.1566	0.4547	0.0457	0.0145	0.0341	0.1958
0.3562	0.1644	0.5114	0.0776	0.0228	0.0822	0.3744
0.3421	0.2018	0.4123	0.0497	0.0175	0.0526	0.3129
0.2989	0.125	0.5326	0.0543	0.0054	0.0489	0.2065
];

repeat_sabun1 = repeat_before_sound - repeat_before_sound_neg;
repeat_sabun2 = repeat_sound - repeat_sound_neg;
repeat_sabun3 = repeat_choice - repeat_choice_neg;

zigzag_sabun1 = zigzag_before_sound - zigzag_before_sound_neg;
zigzag_sabun2 = zigzag_sound - zigzag_sound_neg;
zigzag_sabun3 = zigzag_choice - zigzag_choice_neg;

[size_y,size_x] = size(repeat_sabun1);
repeat_sabun1 = reshape(repeat_sabun1,size_y*size_x,1);
repeat_sabun2 = reshape(repeat_sabun2,size_y*size_x,1);
repeat_sabun3 = reshape(repeat_sabun3,size_y*size_x,1);
repeat_sabun = [repeat_sabun1;repeat_sabun2;repeat_sabun3];

median(repeat_sabun)
signrank(repeat_sabun)

[size_y,size_x] = size(zigzag_sabun1);
zigzag_sabun1 = reshape(zigzag_sabun1,size_y*size_x,1);
zigzag_sabun2 = reshape(zigzag_sabun2,size_y*size_x,1);
zigzag_sabun3 = reshape(zigzag_sabun3,size_y*size_x,1);
zigzag_sabun = [zigzag_sabun1;zigzag_sabun2;zigzag_sabun3];

median(zigzag_sabun)
signrank(zigzag_sabun)

figure
subplot(1,2,1)
boxplot(repeat_sabun, 'symbol', '','Colors', [0 0.5 0])
ylim([-0.2, 0.3])
yline(0,':k')
title('Repeat')
subplot(1,2,2)
boxplot(zigzag_sabun, 'symbol', '','Colors','m')
ylim([-0.2, 0.3])
yline(0,':k')
title('Alternate')

end
